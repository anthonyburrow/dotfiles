#!/bin/bash
set -e

if [ -z "$1" ]; then
    echo "Usage: make_script <script_name>"
    exit 1
fi

SCRIPT_NAME="$1"

if [[ "$SCRIPT_NAME" =~ [[:space:]] ]]; then
    echo "Error: Script name cannot contain spaces"
    exit 1
fi

if [ -z "$GITHUB_USERNAME" ]; then
    echo "Error: GITHUB_USERNAME environment variable is not set"
    exit 1
fi
TEMPLATE_URL="https://github.com/$GITHUB_USERNAME/PythonScriptTemplate"

mkdir -p "$HOME/dev"
TARGET_DIR="$HOME/dev/$SCRIPT_NAME"

if [ -d "$TARGET_DIR" ]; then
    echo "Error: Directory '$TARGET_DIR' already exists"
    exit 1
fi

echo "Creating script '$SCRIPT_NAME' from template..."
git clone --depth 1 "$TEMPLATE_URL" "$TARGET_DIR"

cd "$TARGET_DIR"
rm -rf .git
mv script.py "$SCRIPT_NAME.py"

echo "âœ“ Script '$SCRIPT_NAME' created successfully"
echo "  Location: $TARGET_DIR"
