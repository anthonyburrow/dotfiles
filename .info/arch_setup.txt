####################
# USB Installation #
####################

# rufus -> GPT (uses UEFI)


###################################
# Connect to the internet (Wi-Fi) #
###################################

# View interfaces
ip link

# open iwctl shell
iwctl

# lists devices, only one was "wlan0"
> device list

# not sure what this did
> station wlan0 scan

# list SSIDs
> station wlan0 get-networks

# Connect, it will prompt for password (can tab complete)
> station wlan0 connect "OwO x3"

> exit

ping google.com


########################################
# Formatting and Making New Partitions #
########################################

# list block devices, such as /dev/sda, /dev/nvme0n1
fdisk -l

# Go into command mode on the storage/OS device
fdisk /dev/nvme0n1

# print partitions
> p

# delete partition, it will ask for number to delete
> d

# Delete all but EFI System...use the old EFI but format it later (make sure
# it's 260Mb)

# Now create new partitions (filesystem and swap).
> n

#  It'll ask for number. Let this be swap first
> 2

# Then first sector (leave default) and last sector (specify size instead):
> 8G

# Make the filesystem partition now:
> n
> 3
> <default first>, <default last>

# change the type of swap
> t
> 2

# list all with L (get out with q)
> L

# pick the one that is "Linux swap"
> 19

# write the changes to disk
> w

# Format EFI system
mkfs.fat -F32 /dev/nvme0n1p1

# Format the filesystem
mkfs.ext4 /dev/nvme0n1p3

# Format the swap
mkswap /dev/nvme0n1p2

# Mount the root partition to /mnt
mount /dev/nvme0n1p3 /mnt

# Enable swap
swapon /dev/nvme0n1p2


################################################
# Partitioning/Formatting with Dual Boot (EFI) #
################################################

# Make sure Windows is defragged then shrink
# Disk Management > Right click drive > shrink by amount to make free space

# In Arch:

# Show disks; find sda for the drive you want (/dev/sda for this)
lsblk

# Use this and make "New" on Free Space for
# 1. Root - 40-60 GB Linux Filesystem
# 2. Home - [Remainder of space] Linux Filesystem
# 3. Swap - 2-8 GB Linux Swap
# Remember to change types accordingly
cfdisk /dev/sda

# Format partitions
mkfs.ext4 /dev/sda5   # root
mkfs.ext4 /dev/sda6   # home (optional, if you made it)
mkswap /dev/sda7      # swap

# Mount everything
mount /dev/sda5 /mnt            # root

mkdir /mnt/home
mount /dev/sda6 /mnt/home       # home

mkdir -p /mnt/boot/efi
mount /dev/sda2 /mnt/boot/efi   # efi

swapon /dev/sda7

##################################
# Installation and Configuration #
##################################

# Install essential packages
pacstrap /mnt base linux linux-firmware
genfstab -U /mnt >> /mnt/etc/fstab
arch-chroot /mnt

# Setup bootloader
pacman -S grub efibootmgr
grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB
grub-mkconfig -o /boot/grub/grub.cfg

# Set timezone
ln -sf /usr/share/zoneinfo/America/Chicago /etc/localtime
hwclock --systohc

# install vi
pacman -Syu vi

# Set locale
locale-gen

# uncomment "en_US.UTF-8 UTF-8" from /etc/locale.gen
vi /etc/locale.gen

# create /etc/locale.conf and put in "LANG=en_US.UTF-8"
vi /etc/locale.conf

# set the password
passwd

//// # install iwd (iwctl) so you can connect to internet later
//// pacman -Syu iwd

# Internet stuff
pacman -Syu networkmanager
pacman -Syu network-manager-applet

# exit and restart, done with install USB
exit
reboot
